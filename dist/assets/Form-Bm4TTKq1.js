import{d as B,r as v,aO as C,ak as _,at as E,aP as N,c as p,w as t,aB as V,o as a,u as r,J as $,i as w,a as u,b as o,t as s,j as x,k as F,X as A,A as c,_ as l,F as i,aM as j}from"./sharp-CVs8CQK9.js";import{_ as D}from"./Title.vue_vue_type_script_setup_true_lang-BfrYVsXh.js";import{_ as M}from"./PageBreadcrumb.vue_vue_type_script_setup_true_lang-TRBHJ9GF.js";const O={class:"flex gap-4"},J=B({__name:"Form",props:{form:{},breadcrumb:{},errors:{},cancelUrl:{},endpointUrl:{}},setup(S){const n=S,{entityKey:U,instanceId:h}=v().params,e=new C(n.form,U,h),d=_(!1),b=_(!1),k=_("");E(()=>e.errors,()=>{Object.keys(e.errors).length===0&&(b.value=!1)},{deep:!0});function g(){v().params;const m=()=>{d.value=!0},y=()=>{d.value=!1},f=()=>{e.errors=n.errors,b.value=!0,k.value=n.errors.error};j.post(n.endpointUrl,e.serializedData,{onStart:m,onFinish:y,onError:f})}return(m,y)=>{const f=N("SharpForm");return a(),p(V,null,{breadcrumb:t(()=>[r($)("sharp.display_breadcrumb")?(a(),p(M,{key:0,breadcrumb:m.breadcrumb},null,8,["breadcrumb"])):w("",!0)]),default:t(()=>[u(D,{breadcrumb:m.breadcrumb},null,8,["breadcrumb"]),u(f,{form:r(e),"show-error-alert":b.value,"error-alert-message":k.value,onSubmit:g},{title:t(()=>[o(s(r(e).title),1)]),footer:t(()=>[x("div",O,[u(r(F),{variant:"outline","as-child":""},{default:t(()=>[u(r(A),{href:n.cancelUrl},{default:t(()=>[r(e).canEdit?(a(),c(i,{key:0},[o(s(r(l)("sharp::action_bar.form.cancel_button")),1)],64)):(a(),c(i,{key:1},[o(s(r(l)("sharp::action_bar.form.back_button")),1)],64))]),_:1},8,["href"])]),_:1}),r(e).canEdit?(a(),p(r(F),{key:0,style:{"min-width":"6.5em"},disabled:r(e).isUploading||d.value,onClick:g},{default:t(()=>[r(e).isUploading?(a(),c(i,{key:0},[o(s(r(l)("sharp::action_bar.form.submit_button.pending.upload")),1)],64)):r(h)||r(e).config.isSingle?(a(),c(i,{key:1},[o(s(r(l)("sharp::action_bar.form.submit_button.update")),1)],64)):(a(),c(i,{key:2},[o(s(r(l)("sharp::action_bar.form.submit_button.create")),1)],64))]),_:1},8,["disabled"])):w("",!0)])]),_:1},8,["form","show-error-alert","error-alert-message"])]),_:1})}}});export{J as default};
