import{d as B,r as s,av as E,ai as v,aw as I,ax as N,c as h,w as o,ao as V,o as r,u as e,J as $,h as w,a as l,b as n,t as i,i as D,j as F,W as U,A as m,_ as d,F as u,au as S}from"./sharp-BDJdrkET.js";import{_ as j}from"./Title.vue_vue_type_script_setup_true_lang-aFOxYZbg.js";import{_ as x}from"./PageBreadcrumb.vue_vue_type_script_setup_true_lang-LvUwjMN8.js";const z={class:"flex gap-4"},L=B({__name:"Form",props:{form:{},breadcrumb:{},errors:{}},setup(C){const f=C,{entityKey:K,instanceId:y}=s().params,a=new E(f.form,K,y),b=v(!1);v(!1),I(()=>{a.errors=f.errors});function k(){const{parentUri:t,entityKey:p,instanceId:_}=s().params,c=()=>{b.value=!0},g=()=>{b.value=!1};s().current("code16.sharp.form.create")?S.post(s("code16.sharp.form.store",{parentUri:t,entityKey:p}),a.serializedData,{onStart:c,onFinish:g}):s().current("code16.sharp.form.edit")&&S.post(s("code16.sharp.form.update",{parentUri:t,entityKey:p,instanceId:_}),a.serializedData,{onStart:c,onFinish:g})}return(t,p)=>{const _=N("SharpForm");return r(),h(V,null,{breadcrumb:o(()=>[e($)("sharp.display_breadcrumb")?(r(),h(x,{key:0,breadcrumb:t.breadcrumb},null,8,["breadcrumb"])):w("",!0)]),default:o(()=>[l(j,{breadcrumb:t.breadcrumb},null,8,["breadcrumb"]),l(_,{form:e(a),"show-error-alert":Object.values(f.errors).length>0,onSubmit:k},{title:o(()=>[n(i(t.breadcrumb.items.at(-1).documentTitleLabel),1)]),footer:o(()=>[D("div",z,[l(e(F),{variant:"outline","as-child":""},{default:o(()=>{var c;return[l(e(U),{href:(c=t.breadcrumb.items.at(-2))==null?void 0:c.url},{default:o(()=>[e(a).canEdit?(r(),m(u,{key:0},[n(i(e(d)("sharp::action_bar.form.cancel_button")),1)],64)):(r(),m(u,{key:1},[n(i(e(d)("sharp::action_bar.form.back_button")),1)],64))]),_:1},8,["href"])]}),_:1}),e(a).canEdit?(r(),h(e(F),{key:0,style:{"min-width":"6.5em"},disabled:e(a).isUploading||b.value,onClick:k},{default:o(()=>[e(a).isUploading?(r(),m(u,{key:0},[n(i(e(d)("sharp::action_bar.form.submit_button.pending.upload")),1)],64)):e(y)||e(a).config.isSingle?(r(),m(u,{key:1},[n(i(e(d)("sharp::action_bar.form.submit_button.update")),1)],64)):(r(),m(u,{key:2},[n(i(e(d)("sharp::action_bar.form.submit_button.create")),1)],64))]),_:1},8,["disabled"])):w("",!0)])]),_:1},8,["form","show-error-alert"])]),_:1})}}});export{L as default};
