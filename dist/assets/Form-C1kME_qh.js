import{d as N,r as s,aO as V,ak as y,at as $,aP as A,c as k,w as t,aB as D,o as a,u as e,J as U,i as B,a as d,b as n,t as i,j,k as C,X as x,A as m,_ as l,F as u,aM as E}from"./sharp-Dy832UKq.js";import{_ as z}from"./Title.vue_vue_type_script_setup_true_lang-CH5Rz-nB.js";import{_ as M}from"./PageBreadcrumb.vue_vue_type_script_setup_true_lang-B19zA1OT.js";const O={class:"flex gap-4"},T=N({__name:"Form",props:{form:{},breadcrumb:{},errors:{}},setup(K){const f=K,{entityKey:I,instanceId:g}=s().params,r=new V(f.form,I,g),b=y(!1),p=y(!1),v=y("");$(()=>r.errors,()=>{Object.keys(r.errors).length===0&&(p.value=!1)},{deep:!0});function w(){const{parentUri:o,entityKey:_,instanceId:h}=s().params,c=()=>{b.value=!0},F=()=>{b.value=!1},S=()=>{r.errors=f.errors,p.value=!0,v.value=f.errors.error};s().current("code16.sharp.form.create")?E.post(s("code16.sharp.form.store",{parentUri:o,entityKey:_}),r.serializedData,{onStart:c,onFinish:F,onError:S}):s().current("code16.sharp.form.edit")&&E.post(s("code16.sharp.form.update",{parentUri:o,entityKey:_,instanceId:h}),r.serializedData,{onStart:c,onFinish:F,onError:S})}return(o,_)=>{const h=A("SharpForm");return a(),k(D,null,{breadcrumb:t(()=>[e(U)("sharp.display_breadcrumb")?(a(),k(M,{key:0,breadcrumb:o.breadcrumb},null,8,["breadcrumb"])):B("",!0)]),default:t(()=>[d(z,{breadcrumb:o.breadcrumb},null,8,["breadcrumb"]),d(h,{form:e(r),"show-error-alert":p.value,"error-alert-message":v.value,onSubmit:w},{title:t(()=>[n(i(e(r).title),1)]),footer:t(()=>[j("div",O,[d(e(C),{variant:"outline","as-child":""},{default:t(()=>{var c;return[d(e(x),{href:(c=o.breadcrumb.items.at(-2))==null?void 0:c.url},{default:t(()=>[e(r).canEdit?(a(),m(u,{key:0},[n(i(e(l)("sharp::action_bar.form.cancel_button")),1)],64)):(a(),m(u,{key:1},[n(i(e(l)("sharp::action_bar.form.back_button")),1)],64))]),_:1},8,["href"])]}),_:1}),e(r).canEdit?(a(),k(e(C),{key:0,style:{"min-width":"6.5em"},disabled:e(r).isUploading||b.value,onClick:w},{default:t(()=>[e(r).isUploading?(a(),m(u,{key:0},[n(i(e(l)("sharp::action_bar.form.submit_button.pending.upload")),1)],64)):e(g)||e(r).config.isSingle?(a(),m(u,{key:1},[n(i(e(l)("sharp::action_bar.form.submit_button.update")),1)],64)):(a(),m(u,{key:2},[n(i(e(l)("sharp::action_bar.form.submit_button.create")),1)],64))]),_:1},8,["disabled"])):B("",!0)])]),_:1},8,["form","show-error-alert","error-alert-message"])]),_:1})}}});export{T as default};
