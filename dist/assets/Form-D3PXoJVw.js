import{d as z,r as s,aM as B,ai as y,ar as V,aN as $,c as g,w as o,az as D,o as a,u as e,I as U,h as S,a as d,b as n,t as i,i as j,j as C,W as A,z as m,_ as l,F as u,aK as E}from"./sharp-xia2_OGg.js";import{_ as M}from"./Title.vue_vue_type_script_setup_true_lang-D_iMGXLt.js";import{_ as T}from"./PageBreadcrumb.vue_vue_type_script_setup_true_lang-CiGiiDeW.js";const x={class:"flex gap-4"},q=z({__name:"Form",props:{form:{},breadcrumb:{},errors:{}},setup(I){const f=I,{entityKey:N,instanceId:k}=s().params,r=new B(f.form,N,k),b=y(!1),p=y(!1),v=y("");V(()=>r.errors,()=>{Object.keys(r.errors).length===0&&(p.value=!1)},{deep:!0});function w(){const{parentUri:t,entityKey:_,instanceId:h}=s().params,c=()=>{b.value=!0},F=()=>{b.value=!1},K=()=>{r.errors=f.errors,p.value=!0,v.value=f.errors.error};s().current("code16.sharp.form.create")?E.post(s("code16.sharp.form.store",{parentUri:t,entityKey:_}),r.serializedData,{onStart:c,onFinish:F,onError:K}):s().current("code16.sharp.form.edit")&&E.post(s("code16.sharp.form.update",{parentUri:t,entityKey:_,instanceId:h}),r.serializedData,{onStart:c,onFinish:F,onError:K})}return(t,_)=>{const h=$("SharpForm");return a(),g(D,null,{breadcrumb:o(()=>[e(U)("sharp.display_breadcrumb")?(a(),g(T,{key:0,breadcrumb:t.breadcrumb},null,8,["breadcrumb"])):S("",!0)]),default:o(()=>[d(M,{breadcrumb:t.breadcrumb},null,8,["breadcrumb"]),d(h,{form:e(r),"show-error-alert":p.value,"error-alert-message":v.value,onSubmit:w},{title:o(()=>[n(i(t.breadcrumb.items.at(-1).documentTitleLabel),1)]),footer:o(()=>[j("div",x,[d(e(C),{variant:"outline","as-child":""},{default:o(()=>{var c;return[d(e(A),{href:(c=t.breadcrumb.items.at(-2))==null?void 0:c.url},{default:o(()=>[e(r).canEdit?(a(),m(u,{key:0},[n(i(e(l)("sharp::action_bar.form.cancel_button")),1)],64)):(a(),m(u,{key:1},[n(i(e(l)("sharp::action_bar.form.back_button")),1)],64))]),_:1},8,["href"])]}),_:1}),e(r).canEdit?(a(),g(e(C),{key:0,style:{"min-width":"6.5em"},disabled:e(r).isUploading||b.value,onClick:w},{default:o(()=>[e(r).isUploading?(a(),m(u,{key:0},[n(i(e(l)("sharp::action_bar.form.submit_button.pending.upload")),1)],64)):e(k)||e(r).config.isSingle?(a(),m(u,{key:1},[n(i(e(l)("sharp::action_bar.form.submit_button.update")),1)],64)):(a(),m(u,{key:2},[n(i(e(l)("sharp::action_bar.form.submit_button.create")),1)],64))]),_:1},8,["disabled"])):S("",!0)])]),_:1},8,["form","show-error-alert","error-alert-message"])]),_:1})}}});export{q as default};
